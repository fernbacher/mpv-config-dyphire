# Basics #

vo=gpu                                # Use gpu for Wayland compatibility
gpu-api=vulkan                        # Vulkan is recommended for Linux/Wayland
gpu-context=waylandvk                 # Vulkan context for Wayland; fallback to wayland if needed
hwdec=vaapi-copy                      # VAAPI for hardware decoding on Linux
audio-device=auto                     # Auto-detect audio device
ao=pipewire                           # PipeWire for Wayland audio output
audio-channels=7.1,5.1,stereo         # Common channel layouts, fallback to stereo

# Decoding #

#fbo-format=auto                      # Auto-determined by gpu-api
#vd-lavc-dr=no                        # Default for Intel GPUs
#vd-queue-enable=yes                  # Enable for low-end GPUs if needed
#vd-lavc-threads=8                    # Auto-detect threads by default
#vd-lavc-assume-old-x264=yes          # Enable for old x264 compatibility
#opengl-pbo=yes                       # May improve performance for large videos

# Function #

title=${?pause==yes:‚è∏}${?mute==yes:üîá}${?ontop==yes:üìå}${?demuxer-via-network==yes:${media-title}}${?demuxer-via-network==no:${filename}}
osc=no                                # Disable built-in OSC for third-party scripts
no-title-bar                          # Remove title bar for Wayland
input-ime=no                          # Disable IME unless needed
window-corners=roundsmall             # Wayland-compatible window rounding
autofit-smaller=40%x30%               # Minimum window size
idle=yes                              # Keep mpv running after playback
log-file="~/.config/mpv/files/mpv.log" # Linux path
ontop                                 # Keep window on top
snap-window=yes                       # Snap to screen edges
hr-seek=yes                           # Precise seeking
hr-seek-framedrop=no                  # Prevent frame drops during seeking
save-position-on-quit=yes             # Save playback position
write-filename-in-watch-later-config   # Include filename in watch_later
resume-playback-check-mtime=yes       # Check file modification time
watch-later-dir="~/.config/mpv/cache/watch_later" # Linux path
watch-later-options=start,vid,aid,sid
save-watch-history=yes                # Save playback history
watch-history-path=~/.config/mpv/files/watch_history.jsonl # Linux path
reset-on-next-file=vid,aid,sid,secondary-sid,vf,af,loop-file,deinterlace,contrast,brightness,gamma,saturation,hue,video-zoom,video-rotate,video-pan-x,video-pan-y,panscan,speed,audio-delay,sub-pos,sub-scale,sub-delay,sub-speed,sub-visibility,secondary-sub-visibility
input-ipc-server=/tmp/mpvsocket       # Linux IPC socket
directory-mode=ignore                 # Ignore subdirectories
metadata-codepage=auto                # Auto-detect metadata encoding
msg-level=all=info,auto_profiles=warn # Log level

# OSD #

no-osd-bar
osd-on-seek=msg-bar
osd-bar-w=100
osd-bar-h=2
osd-bar-align-y=-1
osd-font="Noto Sans Mono CJK SC"
osd-font-size=24
osd-color="#FFFFFF"
osd-outline-size=1.0
osd-outline-color="#1C1B1F"
osd-shadow-offset=0
osd-back-color="#1C1B1F"
osd-border-style=outline-and-shadow
osd-playlist-entry=filename
osd-status-msg=${playback-time/full} / ${duration/full} (${percent-pos}%)\nframe: ${estimated-frame-number} / ${estimated-frame-count}
osd-fractions=yes
osd-duration=2000

# Video #

#icc-profile-auto                     # Enable for professional color correction
#icc-intent=0                         # Perceptual mapping
#icc-force-contrast=1000              # Adjust for OLED or high-contrast displays
#icc-3dlut-size=64x64x64              # 3D LUT size
#icc-cache-dir="~/.config/mpv/cache/icc_cache" # Linux path
#use-embedded-icc-profile=no          # Disable embedded ICC profiles
#target-prim=auto                     # Auto-detect color primaries
#target-trc=gamma2.2                  # Gamma for non-HDR displays
#target-contrast=auto                 # Auto contrast
#target-peak=auto                     # Auto peak brightness
#tone-mapping=hable                   # Hable for SDR/HDR mapping
#tone-mapping-param=0.3               # Tone mapping parameter
#gamut-mapping-mode=clip              # Clip for gamut mapping
#hdr-contrast-recovery=0.30           # HDR contrast restoration
#hdr-contrast-smoothness=3.5          # HDR smoothness
#hdr-compute-peak=yes                 # Dynamic HDR tone mapping
#hdr-peak-decay-rate=20               # HDR peak decay
#hdr-scene-threshold-low=1.0          # HDR scene threshold
#hdr-scene-threshold-high=3.0         # HDR scene threshold
#hdr-peak-percentile=99.995           # HDR peak percentile
#allow-delayed-peak-detect=no         # No delayed peak detection
#video-sync=display-resample          # Sync to display
#interpolation                       # Reduce stuttering
#tscale=oversample                    # Interpolation algorithm
#scale=ewa_hanning                    # Upscaling algorithm
#cscale=bilinear                      # Chroma upscaling
#dscale=catmull_rom                   # Downscaling
#scale-antiring=0.5                   # Anti-ringing
#dscale-antiring=0.5                  # Anti-ringing
#linear-upscaling=no                  # Disable linear upscaling
#sigmoid-upscaling=yes                # Non-linear upscaling
#correct-downscaling=yes              # Anti-aliasing for downscaling
#linear-downscaling=no                # Disable linear downscaling
#deband=no                            # Disable debanding by default

# Audio #

audio-file-auto=fuzzy
audio-file-paths=audio;audios;**
alang=english,eng,en,german,ger,de,deu,japanese,jpn,jap,ja,jp,chs,sc,zh-CN,zh-Hans,cht,tc,zh-Hant,zh-HK,zh-TW,chi,zho,zh
gapless-audio=no

# Subtitles #

sub-font-provider=fontconfig           # Use fontconfig on Linux
sub-codepage=gb18030                  # Chinese subtitle encoding
sub-auto=fuzzy
sub-file-paths=sub;subs;subtitles;**
slang=english,eng,en,german,ger,de,deu,japanese,jpn,jap,ja,jp,chs,sc,zh-CN,zh-Hans,cht,tc,zh-Hant,zh-HK,zh-TW,chi,zho,zh
sub-font="Noto Sans CJK SC"
sub-font-size=50
sub-bold=yes
sub-color="#FFFFFF"
sub-outline-size=0.5
sub-outline-color="#000000"
sub-shadow-offset=0.5
sub-back-color="#000000"

# Screenshots #

screenshot-format=webp
screenshot-webp-quality=85
screenshot-webp-compression=6
screenshot-tag-colorspace=no
screenshot-template="~/.config/mpv/files/screen/%{media-title}-%P-%n"

# Script Filter Shaders #

gpu-shader-cache-dir="~/.config/mpv/cache/shaders_cache"
#load-scripts=no
#scripts="~/.config/mpv/scripts/autoload.lua;~/.config/mpv/scripts/playlistmanager.lua;~/.config/mpv/scripts/open_dialog.lua"
input-default-bindings=no

# General parameters #

libplacebo-opts=tone_map_metadata=cie_y

# Profiles #

[ICC]
icc-profile=""
icc-profile-auto
icc-intent=0
icc-force-contrast=1000
icc-3dlut-size=auto
icc-cache-dir="~/.config/mpv/cache/icc_cache"

[ICC+]
icc-profile="~/.config/mpv/icc/ITU-RBT709ReferenceDisplay.icc"
icc-intent=0
icc-force-contrast=no
icc-3dlut-size=auto
icc-cache-dir="~/.config/mpv/cache/icc_cache"

[Target]
icc-profile=""
icc-profile-auto=no
target-prim=auto
target-trc=gamma2.2
target-contrast=auto
target-peak=auto

[Dither]
dither-depth=auto
dither=fruit
dither-size-fruit=6

[Dither+]
dither-depth=auto
dither=error-diffusion
error-diffusion=floyd-steinberg

[Tscale]
video-sync=display-resample
interpolation
tscale=oversample

[Tscale+]
video-sync=display-resample
interpolation
tscale=sphinx
tscale-blur=0.65

[HQ]
scale=ewa_hanning
cscale=bilinear
dscale=catmull_rom
scale-antiring=0.5
dscale-antiring=0.5
linear-upscaling=no
sigmoid-upscaling=yes
correct-downscaling=yes
linear-downscaling=no
deband=no

[DeBand-low]
profile-desc=DeBand low
deband-iterations=1
deband-threshold=48
deband-range=16
deband-grain=16

[DeBand-medium]
profile-desc=deband medium
deband-iterations=2
deband-threshold=64
deband-range=16
deband-grain=24

[DeBand-high]
profile-desc=deband high
deband-iterations=3
deband-threshold=64
deband-range=16
deband-grain=24

[HDR2SDR]
profile-desc=HDR-SDR mapping parameters
target-colorspace-hint=no
tone-mapping=auto
hdr-contrast-recovery=0.30
hdr-compute-peak=auto
hdr-peak-percentile=99.995
hdr-peak-decay-rate=20
hdr-scene-threshold-low=1.0
hdr-scene-threshold-high=3.0
allow-delayed-peak-detect=no

[HDR-PASS]
profile-desc=HDR pass-through parameters
target-colorspace-hint=auto

[SWscaler]
profile-desc=Software scaling configuration
sws-allow-zimg=no
sws-scaler=bicublin
zimg-scaler-chroma=bicubic
zimg-scaler=bicubic
zimg-scaler-param-a=1/3
zimg-scaler-param-b=1/3
zimg-fast=no

[NNEDI3]
profile-desc=Suitable for most scenarios
glsl-shaders="~/.config/mpv/shaders/nnedi3/nnedi3-nns32-win8x4.glsl;~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

[NNEDI3+]
profile-desc=Suitable for most scenarios
glsl-shaders="~/.config/mpv/shaders/nnedi3/nnedi3-nns64-win8x4.glsl;~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

[ravu-zoom]
profile-desc=Suitable for most scenarios
glsl-shaders="~/.config/mpv/shaders/ravu/ravu-zoom-ar-r3.glsl;~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

[FSRCNNX]
profile-desc=Suitable for HD scenarios
glsl-shaders="~/.config/mpv/shaders/igv/FSRCNNX_x2_8-0-4-1.glsl;~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/igv/SSimSuperRes.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

[FSRCNNX+]
profile-desc=Suitable for SD scenarios
glsl-shaders="~/.config/mpv/shaders/igv/FSRCNNX_x1_16-0-4-1_distort.glsl;~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/ravu/ravu-zoom-ar-r3.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

[Ani4K]
profile-desc=Suitable for most animations
glsl-shaders="~/.config/mpv/shaders/Ani4K/Ani4Kv2_ArtCNN_C4F32_i2.glsl"

[AniSD]
profile-desc=Suitable for SD animation
glsl-shaders="~/.config/mpv/shaders/Ani4K/AniSD_ArtCNN_C4F32_i4.glsl"

[Anime4K]
profile-desc=Suitable for most animations
glsl-shaders="~/.config/mpv/shaders/igv/KrigBilateral.glsl;~/.config/mpv/shaders/Anime4K/glsl/Restore/Anime4K_Restore_CNN_Soft_M.glsl;~/.config/mpv/shaders/Anime4K/glsl/Restore/Anime4K_Clamp_Highlights.glsl"

[SSIM]
profile-desc=Suitable for 4K low performance
glsl-shaders="~/.config/mpv/shaders/igv/SSimSuperRes.glsl;~/.config/mpv/shaders/igv/SSimDownscaler.glsl"

# Conditional Profiles #

[SD]
profile-desc=Low-resolution source enhancement
profile-cond=height <= 720 or width <= 720
profile-restore=copy
profile=FSRCNNX+

[Deband]
profile-desc=Sources below YUV420P10 turn on debanding
profile-cond=get("video-params/average-bpp") < 24
profile-restore=copy
deband=yes

[hdr-2390]
profile-cond=p.tone_mapping == "bt.2390" and p.current_vo == "gpu"
profile-restore=copy
tone-mapping-param=2.0

[HDR]
profile-desc=HDR configuration
profile-cond=get("video-out-params/max-luma") > 203
profile-restore=copy
blend-subtitles=no
deband=no
vf=""

[SDR-Gamut]
profile-desc=Gamut mapping for SDR content
profile-cond=get("video-params/primaries") ~= "bt.709" and get("video-params/gamma") == "bt.1886"
profile-restore=copy
gamut-mapping-mode=clip

[video-sync]
profile-desc=Change sync mode for audio adjustment
profile-cond=(speed * audio_speed_correction) > 0 and ((speed * audio_speed_correction) < 0.96 or (speed * audio_speed_correction) > 1.04) and not (get("estimated-vf-fps") > 47 or get("display-fps") > 120)
profile-restore=copy-equal
video-sync=display-tempo

[fps-fix]
profile-desc=Fix power consumption or frame drops
profile-cond=get("estimated-vf-fps") > 47 or get("display-fps") > 120
profile-restore=copy
video-sync=audio

[pgs-fix]
profile-desc=Fix PGS subtitle misalignment
profile-cond=get("video-params/aspect") > 16 / 9
profile-restore=copy
stretch-image-subs-to-screen=yes

[pause]
profile-desc=Unpin from top when paused
profile-cond=pause
profile-restore=copy
ontop=no

[maximized]
profile-desc=Cancel auto window resize when maximized
profile-cond=window_maximized and vid and not get("current-tracks/video/albumart")
profile-restore=copy-equal
auto-window-resize=no

[minimized]
profile-desc=Pause when minimizing
profile-cond=window_minimized and vid and not get("current-tracks/video/albumart")
profile-restore=copy-equal
pause

[end]
profile-desc=Exit full screen after playlist ends
profile-cond=idle_active
no-fullscreen
no-window-maximized

[media-title]
profile-desc=Switch window title for special protocols
profile-cond=path:find('://') ~= nil or path:find('^magnet:') ~= nil
profile-restore=copy
title=${?pause==yes:‚è∏}${?mute==yes:üîá}${?ontop==yes:üìå}${media-title}
osd-playlist-entry=title
